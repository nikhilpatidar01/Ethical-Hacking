
# `arping` – ARP-Based Network Discovery Tool

**`arping`** is a network utility used to discover and probe hosts on a local network by sending **ARP (Address Resolution Protocol)** requests at the **Data Link Layer (Layer 2)** of the OSI model. Unlike traditional `ping`, which uses **ICMP** at the **Network Layer (Layer 3)**, `arping` operates directly at Layer 2, making it ideal for local subnet scanning.

---

## Key Features

* Works at the **Data Link Layer (Layer 2)**.
* Sends **ARP requests** to determine if a host is reachable on the local network.
* Shows **MAC address** of the responding host and **round-trip time**.
* Starts with **broadcast ARP**; after receiving a reply, switches to **unicast**.
* Requires **root privileges** on Linux.
* Only works within the **local subnet** (ARP is not routable).
* Can be used for **MAC spoofing** or **cache poisoning** in advanced scenarios.
* Different implementations available (e.g., Thomas Habets’ version supports pinging by MAC address).

---

## Common Options

| Option         | Description                             |
| -------------- | --------------------------------------- |
| `-f`           | Stop after receiving the first reply.   |
| `-w <seconds>` | Set timeout duration for the operation. |
| `-q`           | Quiet mode (suppress output).           |
| `-v`           | Verbose mode (detailed output).         |
| `-b`           | Send only broadcast ARP requests.       |
| `-D`           | Duplicate address detection mode.       |

---

## Example Usage

```bash
arping 192.168.129.80
```

Sends ARP requests to the IP address and returns replies with MAC address and response time.

---

## Why Use arping?

* To verify if a **host is reachable at the link layer**.
* To discover **MAC addresses** on a local network.
* Useful in environments where **ICMP is blocked** (e.g., firewall rules).
* Complements traditional `ping` by probing the **Layer 2** connectivity.

---

## Common `arping` Commands (Corrected & Structured)

### 1. Basic Command Without Arguments

> Displays help or waits for an IP to send ARP requests to. Without a target IP or valid options, it usually does nothing.

```bash
arping
```

---

### 2. Send ARP Requests to a Host

> Sends ARP requests continuously to the IP `192.168.129.10` until manually stopped. Useful for checking if the device responds to ARP.

```bash
arping 192.168.129.10
```

---

### 3. Send a Single ARP Request

> Sends exactly **one ARP request** and then stops. Useful for quick checks or in scripts.

```bash
arping -c 1 192.168.129.10
```

---

### 4. Specify Source MAC Address

> Sets the source MAC address to `98:28:a6:04:19:2c` for outgoing ARP requests. Useful for **advanced testing** or **MAC spoofing**.

```bash
arping -s 98:28:a6:04:19:2c 192.168.129.10
```

---

### 5. Send One ARP Request with Custom Source MAC

> Combines a **single ARP request** (`-c 1`) with a **custom source MAC address** for IP `192.168.1.51`.

```bash
arping -c 1 -s 98:28:a6:04:19:2c 192.168.1.51
```

---

### 6. Send Two ARP Requests on a Specific Interface with Custom MAC

> Sends **two ARP requests** from interface `eth0` using source MAC `98:28:a6:04:19:2c` to `192.168.1.25`.

```bash
arping -c 2 -s 98:28:a6:04:19:2c -i eth0 192.168.1.25
```

---

### 7. Send 10 ARP Requests with Interface and Source MAC

> Sends **10 ARP requests** from interface `eth0` with source MAC `08:00:27:fb:70:09` to `192.168.1.31`.

>  **Note:** Original command had errors — corrected syntax and added `-c 10`.

```bash
arping -s 08:00:27:fb:70:09 -c 10 -i eth0 192.168.1.31
```

---



---

## Subnet Scan Using arping (Bash Script)

```bash
for i in {1..254}; do
  arping -c 1 192.168.129.$i
done

```

* Iterates through the 192.168.1.0/24 subnet.
* Sends one ARP request to each IP.
* Helps identify active hosts on the local network.

---

## Combined ICMP Ping and ARPing Script Check Online or Active

```bash
#!/bin/bash
# Scan subnet 192.168.1.0/24 using both ICMP and ARP

for i in {1..254}; do
  IP="192.168.1.$i"

  # Ping with 1-second wait
  ping -c 1 -W 1 $IP > /dev/null
  if [ $? -eq 0 ]; then
    echo "Ping: $IP is online"
  fi

  # ARPing with 1-second wait
  arping -c 1 -w 1 $IP > /dev/null
  if [ $? -eq 0 ]; then
    echo "Arping: $IP is online"
  fi
done
```

* Pings and arps every IP in the subnet.
* Detects hosts even if ICMP is disabled but ARP is enabled.

---


