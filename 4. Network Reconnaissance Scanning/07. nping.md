# nping
**nping** is a free, open-source network packet generation tool and advanced ping utility. Part of the **Nmap suite**, it allows users to craft and send customized network packets across multiple protocols such as *TCP*, *UDP*, *ICMP*, and *ARP*, with fine-grained control over packet headers and payloads. Beyond basic host availability checks, nping can be used for advanced network testing, such as stack stress testing, ARP poisoning, denial-of-service (DoS) simulations, route tracing, and response time measurement. It features an **Echo Mode**, which helps analyze packet transit—useful for troubleshooting firewalls, diagnosing network path issues, and detecting packet corruption. nping runs on **Linux, Windows, BSD, and macOS**, and is highly flexible for diverse network measurement and security auditing needs.

### Key Features
- Custom **TCP, UDP, ICMP, and ARP** packet generation.
- Support for multiple target hosts and ports.
- **Echo Mode** for packet transit analysis.
- Route tracing capabilities.
- Ethernet frame generation.
- Experimental **IPv6** support.
- Runs on multiple operating systems.

> **Note:** nping requires appropriate privileges for raw socket operations and should be used responsibly, as it can generate high network traffic.

**In summary:** nping extends the traditional ping utility with powerful packet crafting and analysis capabilities, making it ideal for network professionals and security experts.

---

### Command Examples

#### 1. Show help information
> Prints detailed help about nping options and usage:

```php
nping --help
```
> OR
```php
nping -h
```
#### Output
```php
Nping 0.7.95 ( https://nmap.org/nping )
Usage: nping [Probe mode] [Options] {target specification}

TARGET SPECIFICATION:
  Targets may be specified as hostnames, IP addresses, networks, etc.
  Ex: scanme.nmap.org, microsoft.com/24, 192.168.0.1; 10.0.*.1-24
PROBE MODES:
  --tcp-connect                    : Unprivileged TCP connect probe mode.
  --tcp                            : TCP probe mode.
  --udp                            : UDP probe mode.
  --icmp                           : ICMP probe mode.
  --arp                            : ARP/RARP probe mode.
  --tr, --traceroute               : Traceroute mode (can only be used with 
                                     TCP/UDP/ICMP modes).
TCP CONNECT MODE:
   -p, --dest-port <port spec>     : Set destination port(s).
   -g, --source-port <portnumber>  : Try to use a custom source port.
TCP PROBE MODE:
   -g, --source-port <portnumber>  : Set source port.
   -p, --dest-port <port spec>     : Set destination port(s).
   --seq <seqnumber>               : Set sequence number.
   --flags <flag list>             : Set TCP flags (ACK,PSH,RST,SYN,FIN...)
   --ack <acknumber>               : Set ACK number.
   --win <size>                    : Set window size.
   --badsum                        : Use a random invalid checksum. 
UDP PROBE MODE:
   -g, --source-port <portnumber>  : Set source port.
   -p, --dest-port <port spec>     : Set destination port(s).
   --badsum                        : Use a random invalid checksum. 
ICMP PROBE MODE:
  --icmp-type <type>               : ICMP type.
  --icmp-code <code>               : ICMP code.
  --icmp-id <id>                   : Set identifier.
  --icmp-seq <n>                   : Set sequence number.
  --icmp-redirect-addr <addr>      : Set redirect address.
  --icmp-param-pointer <pnt>       : Set parameter problem pointer.
  --icmp-advert-lifetime <time>    : Set router advertisement lifetime.
  --icmp-advert-entry <IP,pref>    : Add router advertisement entry.
  --icmp-orig-time  <timestamp>    : Set originate timestamp.
  --icmp-recv-time  <timestamp>    : Set receive timestamp.
  --icmp-trans-time <timestamp>    : Set transmit timestamp.
ARP/RARP PROBE MODE:
  --arp-type <type>                : Type: ARP, ARP-reply, RARP, RARP-reply.
  --arp-sender-mac <mac>           : Set sender MAC address.
  --arp-sender-ip  <addr>          : Set sender IP address.
  --arp-target-mac <mac>           : Set target MAC address.
  --arp-target-ip  <addr>          : Set target IP address.
IPv4 OPTIONS:
  -S, --source-ip                  : Set source IP address.
  --dest-ip <addr>                 : Set destination IP address (used as an 
                                     alternative to {target specification} ). 
  --tos <tos>                      : Set type of service field (8bits).
  --id  <id>                       : Set identification field (16 bits).
  --df                             : Set Don't Fragment flag.
  --mf                             : Set More Fragments flag.
  --evil                           : Set Reserved / Evil flag.
  --ttl <hops>                     : Set time to live [0-255].
  --badsum-ip                      : Use a random invalid checksum. 
  --ip-options <R|S [route]|L [route]|T|U ...> : Set IP options
  --ip-options <hex string>                    : Set IP options
  --mtu <size>                     : Set MTU. Packets get fragmented if MTU is
                                     small enough.
IPv6 OPTIONS:
  -6, --IPv6                       : Use IP version 6.
  --dest-ip                        : Set destination IP address (used as an
                                     alternative to {target specification}).
  --hop-limit                      : Set hop limit (same as IPv4 TTL).
  --traffic-class <class> :        : Set traffic class.
  --flow <label>                   : Set flow label.
ETHERNET OPTIONS:
  --dest-mac <mac>                 : Set destination mac address. (Disables
                                     ARP resolution)
  --source-mac <mac>               : Set source MAC address.
  --ether-type <type>              : Set EtherType value.
PAYLOAD OPTIONS:
  --data <hex string>              : Include a custom payload.
  --data-string <text>             : Include a custom ASCII text.
  --data-length <len>              : Include len random bytes as payload.
ECHO CLIENT/SERVER:
  --echo-client <passphrase>       : Run Nping in client mode.
  --echo-server <passphrase>       : Run Nping in server mode.
  --echo-port <port>               : Use custom <port> to listen or connect.
  --no-crypto                      : Disable encryption and authentication.
  --once                           : Stop the server after one connection.
  --safe-payloads                  : Erase application data in echoed packets.
TIMING AND PERFORMANCE:
  Options which take <time> are in seconds, or append 'ms' (milliseconds),
  's' (seconds), 'm' (minutes), or 'h' (hours) to the value (e.g. 30m, 0.25h).
  --delay <time>                   : Adjust delay between probes.
  --rate  <rate>                   : Send num packets per second.
MISC:
  -h, --help                       : Display help information.
  -V, --version                    : Display current version number. 
  -c, --count <n>                  : Stop after <n> rounds.
  -e, --interface <name>           : Use supplied network interface.
  -H, --hide-sent                  : Do not display sent packets.
  -N, --no-capture                 : Do not try to capture replies.
  --privileged                     : Assume user is fully privileged.
  --unprivileged                   : Assume user lacks raw socket privileges.
  --send-eth                       : Send packets at the raw Ethernet layer.
  --send-ip                        : Send packets using raw IP sockets.
  --bpf-filter <filter spec>       : Specify custom BPF filter.
OUTPUT:
  -v                               : Increment verbosity level by one.
  -v[level]                        : Set verbosity level. E.g: -v4
  -d                               : Increment debugging level by one.
  -d[level]                        : Set debugging level. E.g: -d3
  -q                               : Decrease verbosity level by one.
  -q[N]                            : Decrease verbosity level N times
  --quiet                          : Set verbosity and debug level to minimum.
  --debug                          : Set verbosity and debug to the max level.
EXAMPLES:
  nping scanme.nmap.org
  nping --tcp -p 80 --flags rst --ttl 2 192.168.1.1
  nping --icmp --icmp-type time --delay 500ms 192.168.254.254
  nping --echo-server "public" -e wlan0 -vvv 
  nping --echo-client "public" echo.nmap.org --tcp -p1-1024 --flags ack

SEE THE MAN PAGE FOR MANY MORE OPTIONS, DESCRIPTIONS, AND EXAMPLES


```

#### 2. Basic ping to a host (ICMP by default)
> Sends ICMP echo requests to dns.google and shows response times:

```php
nping dns.google
```

#### 3. Send ARP request to a single IP on your local network
> Checks if 192.168.129.4 responds to ARP (Layer 2 check):

```php
nping --arp 192.168.129.4
```

#### 4. Send only one ARP request
> `-c 1` sends exactly one packet:

```php
nping --arp 192.168.129.4 -c 1
```

#### 5. ARP scan on a subnet
> Sends one ARP request to each IP in 192.168.129.80/24:

```php
nping --arp 192.168.129.80/24 -c 1
```

#### 6. ARP requests to a list of IPs
> Comma-separated IPs: 192.168.129.31, .60, .200, .145

```php
nping --arp 192.168.129.31,60,200,145 -c 1
```

#### 7. TCP packets to port 80 with TTL=2
> For checking router/firewall response:

```php
nping --tcp -p 80 --ttl 2 192.168.129.145
```

#### 8. ICMP "time exceeded" packets
> Used for traceroute/diagnostics:

```php
nping --icmp --icmp-type time-exceeded 192.168.129.10
```

#### 9. Test if TCP port 443 is open (SYN scan)
> Checks if HTTPS port is listening:

```php
nping --tcp -p 443 192.168.129.4
```

#### 10. Send TCP RST packet to port 443 with TTL=2
> Resets TCP connection (useful for firewalls):

```php
nping --tcp -p 443 --flags RST --ttl 2 192.168.129.4
```

#### 11. Start an Nping Echo Server with passphrase "public"
> Useful for running echo tests from other nping clients:

```php
nping --echo-server "public"
```
---

# nping UDP Mode Examples

Nping can generate UDP packets for network testing, discovery, and diagnostics. Here are practical UDP examples:

#### 1. Send a UDP packet to a host (default port 33434)
> Sends a probe to 192.168.129.145:

```php
nping --udp 192.168.129.145
```

#### 2. Specify UDP destination port
> Target port 53 (DNS):

```php
nping --udp -p 53 192.168.129.145
```

#### 3. Multiple/range of UDP ports
> Multiple:  
  ```php
  nping --udp -p 53,161,12345,80 192.168.129.145
  ```
> Range:  
  ```php
  nping --udp -p 1000-1010 192.168.129.145
  ```

#### 4. Spoof source port (requires privileges)
> Set source port to 50505:

```php
sudo nping --udp -g 50505 -p 53 192.168.129.145
```

#### 5. Send a set number of UDP packets
> Sends 5 UDP packets:

```php
nping --udp -p 53 -c 5 192.168.129.145
```

#### 6. UDP packet with ASCII custom data
> Sends "HelloUDP" as payload:

```php
nping --udp -p 1337 --data-string "HelloUDP" 192.168.129.4
```

#### 7. UDP packet with 100 bytes random data

```php
nping --udp -p 53 --data-length 100 192.168.129.4
```

#### 8. UDP packet with invalid checksum (for testing)
> Makes the packet non-RFC compliant:

```php
sudo nping --udp --badsum -p 53 192.168.129.4
```

#### 9. Send 2 UDP packets with custom message to a server

```php
nping --udp -p 1337 --data-string "CustomMessage" -c 2 192.168.129.4
```

### UDP Command Syntax Overview

- `--udp` : Use UDP protocol mode.
- `-p ` : Target port(s)—single, comma-separated, or range.
- `-g ` : Source port (may require root).
- `--data-string "DATA"` : Custom ASCII payload.
- `--data-length ` : Random byte payload of given length.
- `-c ` : Number of packets.
- `--badsum` : Use invalid UDP checksum.

For UDP-based device/service testing, combine these options as needed for your scenario. Run with elevated privileges if packet spoofing or special flags are required.

---
