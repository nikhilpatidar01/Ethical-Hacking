
# Nmap Scanning Workflow

Nmap (Network Mapper) is a powerful open-source tool used for scanning networks, finding vulnerabilities, and gathering information about targets. A good Nmap scan isn’t just about running a single command — it follows a clear step-by-step process to collect accurate, useful, and stealthy details about a host or network. Here’s the complete workflow of a typical Nmap scan:

---

## **1. Ping the Host (Host Discovery)**

- **Purpose:** To check if the target system is online before performing deeper scans, avoiding wasted time and reducing unnecessary noise on the network.

- **How It Works:**
Nmap sends specific packets to the target to elicit a response. If the host responds, it’s marked as “alive” and included in further scanning.

**Common Host Discovery Methods:**

1. **ARP Ping** (Local Networks)

   * Sends ARP requests at Layer 2.
   * Works only on the local subnet.
   * Fast and reliable for LAN(Private IP) scanning.
   * Nmap uses ARP packets instead of ICMP in local networks.
  
   Example:

   > Verbose Mode = -v 

   ```
     nmap -v 10.93.53.145
   ```

3. **ICMP Ping** (Over the LAN)

   * Uses Echo Request packets (like the `ping` command).
   * Can be blocked by firewalls, so not always reliable.
   * Nmap uses ICMP echo requests to check if the host is up. 

   Example:

     ```
     nmap -v 8.8.8.8
     ```
     > Port Scan = -p
     ```
     nmap -v -p 4455 8.8.8.1
     ```

5. **TCP Ping**

   * Sends SYN packets to common ports (e.g., 80, 443).
   * Useful when ICMP is blocked.
   * Nmap can fall back ICMP and ARP ping to TCP or UDP ping to check host availability.

 Example: TCP SYN Ping on port 80

  > TCP SYN Ping = -PS
    
  ```
     nmap -v -PS -p 80 8.8.8.8
  ```

7. **UDP Ping**

   * Sends UDP packets to random ports to check responses.
   * May trigger ICMP “port unreachable” messages, indicating the host is alive.
   * Nmap can fall back ICMP and ARP ping to TCP or UDP ping to check host availability.
 Example: UDP Ping on port 53 (DNS)

> UDP Ping = -PU

```
nmap -v -PU -p 53 8.8.8.8
```

---

## **2. PTR Record (Reverse DNS Lookup) Check**

**Purpose:** PTR records are used to resolve an IP address back to a domain name.
Nmap can perform reverse DNS lookups during scans.
**Why It’s Important:**

* Reveals target naming conventions.
* Can expose the organization or system role (e.g., `mail.example.com`).
* Helps in mapping network topology.

Example: 

```
nmap -v armourinfosec.com
```

**Process:-**
- Domain → A/AAAA record → IP address
- IP → PTR record → Domain name

- Wireshark Filter Example (to capture PTR lookup traffic):
```
ip.addr == 8.8.8.8 && udp.port == 53
```
---

## **3. Port Scanning (Default Top Common 1000 Ports)**

**Purpose:** To identify which network services are accessible on the target.
**How It Works:**

* Sends packets to ports and analyzes responses.
* Categorizes ports as **Open**, **Closed**, or **Filtered**.

**Common Scan Types:**

1. **TCP SYN Scan (-sS)** — Stealthy, does not complete TCP handshake.
2. **TCP Connect Scan (-sT)** — Completes handshake, less stealthy.
3. **UDP Scan (-sU)** — Finds services like DNS, SNMP, NTP.
4. **Full Port Range (-p-)** — Checks all 65,535 ports.

**Example:**
```
nmap -sS -p- armourinfosec.com
```
---

## **4. Service and Version Detection**

**Purpose:** To determine **exact services** and **versions** running on open ports.
**Why It’s Important:**

* Identifies outdated or vulnerable software.
* Helps tailor attacks or audits to specific versions.

Example:

> Version Detection = -sV

```
nmap -v -sV armourinfosec.com
```

**How It Works:**

* Sends specially crafted packets to open ports.
* Analyzes responses against a large database of service signatures.

---

## **5. OS Detection**

**Purpose:** To identify the target’s operating system and device type.
**Why It’s Useful:**

* Reveals attack surfaces specific to that OS.
* Helps in vulnerability mapping.
Example:

> OS Detection = -O

```
nmap -O armourinfosec.com
```
**How It Works:**
* Sends multiple TCP, UDP, and ICMP probes.
* Compares timing, flags, and response behavior to an OS fingerprint database.

---

## **6. Save the Output**
**Purpose:** To document results for analysis, reporting, or future comparison.
**Formats Supported:**
* **Normal Output** — Human-readable.
* **XML Output** — For importing into other tools.
* **Grepable Output** — For filtering with command-line tools.

Examples:

```
nmap -oN results.txt armourinfosec.com
nmap -oX results.xml armourinfosec.com
nmap -oG results.gnmap armourinfosec.com
```

---

## **7. Optional: Aggressive Scan for Maximum Info**

Combines multiple scanning features in one command:
> Aggressive Scan (Advance Scan) = -A
```
nmap -A armourinfosec.com
```
---


### **Nmap Scanning Workflow – Quick Summary**

> Nmap (Network Mapper) is a free, open-source tool for scanning networks, finding vulnerabilities, and gathering target information. A proper scan follows a step-by-step approach for accuracy and stealth:

1. **Host Discovery (Ping Scan)** – Check if the target is online using ARP, ICMP, TCP, or UDP ping.
2. **Reverse DNS Lookup (PTR Record)** – Find the domain name linked to the IP.
3. **Port Scanning** – Detect open, closed, or filtered ports (TCP, UDP, full range).
4. **Service & Version Detection** – Identify running services and software versions.
5. **OS Detection** – Determine the target’s operating system and device type.
6. **Save Output** – Store results in TXT, XML, or Grepable format for analysis.
7. **Aggressive Scan (-A)** – Combine OS detection, version detection, scripts, and traceroute in one command.

**Example full scan:**

```
nmap -PR -sS -p- -sV -O -oN scan_results.txt armourinfosec.com
```

---

