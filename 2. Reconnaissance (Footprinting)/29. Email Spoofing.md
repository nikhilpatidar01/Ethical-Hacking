
# 📧 Email Spoofing 

---
## 🔍 What is Email Spoofing?

> **Email Spoofing** is a technique used in cyber attacks where the **“From” address of an email is forged** to make it look like it came from a **trusted or legitimate source**, even though it didn’t.

🎯 **Goal**: Trick the victim into **opening**, **trusting**, or **acting** on a fraudulent email.
Examples include:

* Clicking malicious links
* Downloading malware
* Revealing credentials or sensitive data

---

## ⚙️ How Email Spoofing Works

* SMTP (Simple Mail Transfer Protocol) **has no built-in authentication**.
* Attackers modify the **MAIL FROM** or **"From:"** headers.
* They often use **open mail relays** or **misconfigured MTAs**.
* Advanced spoofing includes:

  * Fake **Reply-To**
  * Fake **Display Names**
  * Forged **full headers**

---

### ✉️ Example of a Spoofed Email Header

```plaintext
From: "Bank Support" <esupport@bank.com>
Reply-To: hacker@gmail.com
Received: from attacker-server.com (192.0.2.1)
```

Looks like it’s from the bank — but the actual server is from an attacker.

---

## ⚠️ Risks of Email Spoofing

* 🎣 **Phishing Attacks**
* 💼 **Business Email Compromise (BEC)**
* 🛑 **Credential Theft**
* 🦠 **Malware/Ransomware Delivery**

---

## 🧠 How to Detect Spoofed Emails

| 🔍 Method                       | 💡 What to Check                   |
| ------------------------------- | ---------------------------------- |
| Check **headers**               | Look at “Received:” lines & IPs    |
| Inspect **Reply-To address**    | Different from “From”? Suspicious. |
| Validate **SPF / DKIM / DMARC** | Use header analysis tools          |

---

## 🛡️ Preventing Email Spoofing (Defensive Setup)

### ✅ Email Authentication Protocols

| 🧱 Protocol                                                             | 📌 Purpose                                                 |
| ----------------------------------------------------------------------- | ---------------------------------------------------------- |
| **SPF** (Sender Policy Framework)                                       | Declares which mail servers can send mail for your domain  |
| **DKIM** (DomainKeys Identified Mail)                                   | Digitally signs emails to verify they weren’t altered      |
| **DMARC** (Domain-based Message Authentication Reporting & Conformance) | Combines SPF & DKIM and enforces policy + reports spoofing |

---

## 🧪 Tools to Analyze Spoofed Emails

### 🔧 Online Analysis Tools

| 🛠️ Tool                                                                                             | 🔍 Function                          |
| ---------------------------------------------------------------------------------------------------- | ------------------------------------ |
| [MXToolbox SPF/DKIM Checker](https://mxtoolbox.com)                                                  | View & validate email authentication |
| [Google Admin Toolbox - Message Header Analyzer](https://toolbox.googleapps.com/apps/messageheader/) | Inspect email headers visually       |
| [CyberForensics Email Tracer](https://cyberforensics.in)                                             | Trace sender’s IP, geolocation       |
| [IP2Location Email Tracer](https://www.ip2location.com/email-tracer)                                 | Trace spoofed sender origin          |

---

### ⚠️ Online Email Spoofing Tools *(For Educational Use Only)*

| 🛠️ Tool                                   | 🌐 Description                                            |
| ------------------------------------------ | --------------------------------------------------------- |
| [Emkei.cz](https://emkei.cz/)              | Most used fake mailer interface with full header spoofing |
| [Anonymailer.net](https://anonymailer.net) | Send spoofed mails without registration                   |
| \[Sendmail Testing Labs]                   | (Use local tools like SET, Metasploit, etc.)              |

> ⚠️ Use only in **CTF**, **demo**, or **your own domains** — never against real targets.

---

## 🧰 Check DMARC/SPF/DKIM Records (CLI Mode)

```bash
# Check TXT Records (DMARC, SPF, DKIM)
dig -t txt armourinfosec.com
dig -t txt india.gov.in
```

### 🔍 What to Look for:

* `v=DMARC1` → DMARC present
* `v=spf1` → SPF defined
* `k=rsa; p=` → DKIM public key

---

## ✅ Summary Table

| 👀 Term            | ✅ Purpose                                                |
| ------------------ | -------------------------------------------------------- |
| **Email Spoofing** | Fake sender address to mislead recipient                 |
| **SMTP**           | No native auth — vulnerable to header manipulation       |
| **SPF**            | Checks IP allowed to send email for a domain             |
| **DKIM**           | Ensures email integrity via digital signature            |
| **DMARC**          | Combines SPF + DKIM to enforce email policy              |
| **Tools**          | Emkei, MXToolbox, Google Header Analyzer, CyberForensics |

---
