
### ✉️ What is Email?

**Email (Electronic Mail)** allows users to send and receive messages over the internet.

#### 📅 Three Parts of an Email Address:

Example: `nikhil@patidar.com`

1. **nikhil** — Username or account name
2. **@** — Separator
3. **patidar.com** — Domain (company, group, or department)

---

### 📧 Mail User Agent (MUA)

A **Mail User Agent (MUA)** is software that allows users to **compose, send, receive, and manage** emails.

#### 🔧 Desktop-Based MUA Programs:

| MUA Program         | Platform              | Description                                                  |
| ------------------- | --------------------- | ------------------------------------------------------------ |
| Microsoft Outlook   | Windows, macOS        | Feature-rich client, supports Exchange, POP3, IMAP           |
| Mozilla Thunderbird | Windows, macOS, Linux | Free and open-source; supports add-ons and multiple accounts |
| eM Client           | Windows, macOS        | Simple UI, calendar integration                              |
| Mailbird            | Windows               | Lightweight, supports third-party apps                       |
| Apple Mail          | macOS, iOS            | Default client for Apple devices                             |
| The Bat!            | Windows               | Advanced filtering and encryption support                    |
| Claws Mail          | Linux, Windows        | Lightweight and performance-focused                          |
| Evolution           | Linux (GNOME)         | Default GNOME email client with calendar and tasks           |

#### 📁 Web-Based MUA Clients:

* Gmail (via browser)
* Outlook.com
* Yahoo Mail
* ProtonMail

---

### 📩 Mail Delivery Agent (MDA)

A **Mail Delivery Agent (MDA)** is a software component responsible for **receiving email messages** from the MTA and **delivering** them to the recipient's mailbox.

#### ⚙️ MDA Workflow:

```
[Sender MUA] → [Sender MTA] → [Recipient MTA] → [Recipient MDA] → [Recipient Mailbox]
```

* MTA routes the email.
* MDA performs final delivery to inbox (e.g., `/var/mail/username` or `Maildir`).

#### ⚡ Common MDA Protocols:

| Protocol | Description                                     | Default Port | Secure Port |
| -------- | ----------------------------------------------- | ------------ | ----------- |
| POP3     | Downloads email to client, deletes from server  | 110          | 995         |
| IMAP     | Accesses emails on server, syncs across devices | 143          | 993         |

#### 📄 Popular MDA Software:

| MDA Tool        | Description                                            |
| --------------- | ------------------------------------------------------ |
| Procmail        | One of the oldest, supports filtering and mail sorting |
| Maildrop        | Lightweight MDA used with Courier Mail Server          |
| Dovecot         | Common for IMAP/POP3 + mailbox delivery                |
| Postfix (Local) | Can be configured to deliver locally                   |
| Fetchmail       | Retrieves remote mail, works with MDA for delivery     |

#### 🔐 Key Points:

* MDA **does not send** emails.
* Tasks:

  * Filter spam
  * Sort emails into folders
  * Trigger scripts on delivery
* Often integrated with Postfix, Dovecot, etc.

---

### 📢 Mail Transfer Agent (MTA)

A **Mail Transfer Agent (MTA)** is responsible for **sending, receiving, and routing** email between mail servers.

#### ⚙️ MTA Workflow:

```
[Sender MUA] → [Sender MTA] → [Internet] → [Recipient MTA] → [Recipient MDA] → [Recipient Mailbox]
```

#### 🔢 Protocol Used:

| Protocol | Purpose          | Unencrypted Port | Secure Port               |
| -------- | ---------------- | ---------------- | ------------------------- |
| SMTP     | Send/relay email | 25               | 465 (SSL), 587 (STARTTLS) |

#### 📄 Popular MTA Software:

| MTA Tool           | Description                                |
| ------------------ | ------------------------------------------ |
| Postfix            | Secure, fast, open-source (Linux default)  |
| Sendmail           | Powerful but complex, early MTA            |
| Exim               | Flexible, used in cPanel servers           |
| Qmail              | Modular and secure design                  |
| Microsoft Exchange | Enterprise mail server with MTA capability |

#### ⛓️ MTA Security Features:

* TLS encryption
* SPF/DKIM/DMARC authentication
* Anti-spam, rate limiting
* DNS lookups, routing rules
* Activity logging

---

### 📊 Email Flow Diagram: MUA → MTA → MDA

```
[Sender MUA] → [Sender MTA] → [Recipient MTA] → [Recipient MDA] → [Recipient Mailbox]
```

#### Protocol Mapping:

* **MUA → MTA**: SMTP
* **MTA → MTA**: SMTP
* **MTA → MDA**: Local Delivery
* **MDA → MUA (Read)**: POP3 or IMAP

---

### 🔎 How to Check MTA Logs

#### ✉️ Postfix Logs:

Location: `/var/log/mail.log`

```bash
sudo grep postfix /var/log/mail.log
sudo grep "status=sent" /var/log/mail.log
```

#### ✉️ Exim Logs:

| Log File                | Purpose           |
| ----------------------- | ----------------- |
| /var/log/exim/mainlog   | General email log |
| /var/log/exim/rejectlog | Rejected emails   |
| /var/log/exim/paniclog  | Critical errors   |

```bash
sudo tail -f /var/log/exim/mainlog
```

---

### 🔍 How Email Tracking & Tracing Works

When an email is sent, every mail server it passes adds a **"Received" header**.

#### 📊 With these headers you can:

* Identify **sender’s IP address**
* View **timestamps** and delivery path
* Detect **spoofing or forged headers**

#### 🎨 Example (Simplified Email Header):

```
Received: from unknown (HELO mail.example.com) (192.168.1.10)
by mail.yourdomain.com with SMTP; Thu, 1 Jul 2025 +0530
```

* `192.168.1.10` — IP address of sender
* `mail.example.com` — Hostname used
* Timestamp shows delivery timeline

---
