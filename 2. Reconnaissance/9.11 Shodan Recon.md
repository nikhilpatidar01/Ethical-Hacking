
# ğŸ›°ï¸ **Shodan-Recon**

## **Shodan Recon Overview**

**Shodan** is a search engine for internet-connected devices. Itâ€™s widely used in cybersecurity for:

* Reconnaissance
* Identifying exposed systems & services
* Mapping attack surfaces
* Finding potential vulnerabilities

---

### ğŸŒ Useful Links:

* ğŸ”— Website: [https://www.shodan.io](https://www.shodan.io)
* ğŸ“š Filter Reference: [https://www.shodan.io/search/filters](https://www.shodan.io/search/filters)

---

## âš™ï¸ How Shodan Works

---

### 1. **Global Internet Scanning**

Shodan uses a vast network of scanners to connect to **every public IPv4 address** and **interacts with open ports**, acting like a **banner grabber**.

ğŸ” For example:

* Connects to `x.x.x.x:80` â†’ saves HTTP headers
* Connects to `x.x.x.x:21` â†’ saves FTP banner

---

### 2. **Banner Collection**

When Shodan connects to a service, it collects exposed **banners/metadata** such as:

* Software name & version (e.g., Apache 2.4.7)
* OS type & version
* SSL certificate details
* Web server headers
* Auth methods
* Error messages
* Custom HTML titles/messages

---

### 3. **Indexing and Tagging**

Collected data is indexed and **tagged based on**:

* `port:` (e.g., `port:80`)
* `product:` (e.g., `product:"Apache"`)
* `org:` (e.g., `org:"Airtel"`)
* `country:` (e.g., `country:US`)
* `vuln:` (e.g., `vuln:CVE-2023-12345`)
* `ssl:` fields
* `http.component:` (e.g., `http.component:"WordPress"`)

---

### 4. **Vulnerability Matching**

Shodan matches banners with **known CVEs** using:

* National Vulnerability Database (NVD)
* Internal vulnerability signature sets

If matched, the system flags it as:
`vuln:CVE-XXXX-XXXX`

---

### 5. **User Interfaces + API Access**

You can access Shodan via:

* ğŸŒ Web UI: [https://www.shodan.io](https://www.shodan.io)
* ğŸ’» Shodan CLI
* ğŸ”‘ Shodan API
* ğŸ”Œ Integrations with red team tools & threat intel platforms

---

## ğŸ“Š Summary Table

| Stage       | Description                                      |
| ----------- | ------------------------------------------------ |
| Scanning    | Shodan probes IPs and ports like a port scanner  |
| Banner Grab | Collects banner/response data from open services |
| Parsing     | Extracts product, version, OS, etc.              |
| Indexing    | Tags with location, org, protocol, etc.          |
| CVE Mapping | Matches services with known vulnerabilities      |
| Access      | Web, CLI, and API for searching and automation   |

---

## ğŸ” Account Setup

1. Register on [Shodan](https://www.shodan.io).
2. Visit your [profile](https://account.shodan.io) to get your **API Key**.

---

## ğŸ” Basic Search Usage

```
apache
ftp
wordpress
nginx
cisco ios
```

---

## ğŸ¯ Using Filters to Narrow Results

```sh
apache port:80 country:US
```

---

## ğŸ” Filter Reference

### ğŸ”¢ port: â€” Search by Open Port

```sh
port:80
port:443
port:22
port:21
```

ğŸ§ª **Examples:**

```sh
port:80 apache
device:webcam port:554
```

---

### ğŸ”§ product: â€” Search by Specific Service/Product

```sh
product:"apache"
product:"apache tomcat"
product:"Remote Desktop Protocol"
product:"LiteSpeed httpd"
```

---

### ğŸ”— Combined Filters

```sh
port:8080 product:"Apache Tomcat"
```

---

### ğŸŒ http.component: â€” Web Technologies

```sh
http.component:"WordPress"
http.component:"PHP"
http.component:"MySQL"
http.component:"Yoast SEO"
```

---

### ğŸ” `http.component` / `http.status` / `version`

```sh
http.component:"wordpress" http.status:200
http.component:"wordpress" version:"6.2"
```

---

### ğŸ›°ï¸ `asn:` â€“ Filter by ASN

```sh
asn:AS26560
asn:AS526560
```

#### ğŸ”— Useful ASN Lookup Tools:

* ğŸŒ [https://asnlookup.com](https://asnlookup.com)
* ğŸŒ [https://hackertarget.com/as-ip-lookup/](https://hackertarget.com/as-ip-lookup/)
* ğŸŒ [https://bgp.he.net/](https://bgp.he.net/)

---

### ğŸŒ `net:` â€“ Filter by IP Range / CIDR

```sh
net:8.8.8.0/24
net:103.86.99.0/24
```

---

### ğŸ”¤ `hostname:` â€“ Filter by Hostname

```sh
hostname:tesla.com
hostname:*.gov
```

---

### ğŸ’½ `os:` â€“ Operating System Filter

```sh
os:"Windows Server 2012"
os:"Ubuntu" port:22
```

---

### ğŸŒ `country:` / `city:` â€“ Geo Filter

```sh
country:IN
country:IN city:Mumbai
```

---

### ğŸ“ `geo:` â€“ Latitude / Longitude

```sh
geo:"32.800900,-117.000900"
```

---

### ğŸ¢ `org:` â€“ Organization Filter

```sh
org:"Google"
org:"HATHWAY CABLE AND DATACOM LIMITED"
```

---

### ğŸ§¾ `title:` â€“ Match HTML `<title>` Tag

```sh
title:"Apache Tomcat/9.0.97"
title:"armour"
```

---

### ğŸ–¥ï¸ `has_screenshot:` â€“ Remote Desktop / Web UI Screenshot

```sh
port:3389 has_screenshot:true
product:"Remote Desktop Protocol"
```

---

### ğŸ”’ `ssl:` â€“ SSL/TLS Certificate Info

```sh
ssl:"Yum Brands Inc."
ssl.cert.subject.cn:"*.pizzahut.com"
```

---

### ğŸ” `vuln:` â€“ CVE Search (Known Vulnerabilities)

```sh
vuln:CVE-2019-19781 country:DE
vuln:CVE-2024-52318 hostname:tesla.com
```

---

### â° `before:` / `after:` â€“ Time of Index

```sh
after:"2024-01-01"
before:"2025-01-01"
```

---

### ğŸ“· `device:` â€“ Filter by Device Type

```sh
device:webcam
```

---

### ğŸ§  `tag:` â€“ ICS / SCADA / PLC Systems

```sh
tag:ics
tag:scada
tag:plc
```

---

### ğŸ”‘ `hash:` â€“ Match by Banner Hash

```sh
hash:-1761231231
```

---

## âœ… BONUS: Useful Tools for Recon & Enrichment

| Tool                     | Link                                                                     |
| ------------------------ | ------------------------------------------------------------------------ |
| ğŸ” ASN Lookup            | [https://asnlookup.com](https://asnlookup.com)                           |
| ğŸŒ HackerTarget IP Tools | [https://hackertarget.com/ip-tools/](https://hackertarget.com/ip-tools/) |
| ğŸ“Š BGP Routes & ASN      | [https://bgp.he.net/](https://bgp.he.net/)                               |
| ğŸŒ IP Geolocation        | [https://ipinfo.io/](https://ipinfo.io/)                                 |
| ğŸ•µï¸â€â™‚ï¸ Shodan Search     | [https://www.shodan.io/](https://www.shodan.io/)                         |

---



